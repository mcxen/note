# 项目申请书

项目名称: openGauss对C3P0框架的兼容性测试

项目主导师:shenzheng [shenzheng4@huawei.com](mailto:shenzheng4@huawei.com)

申请人:  陈贤文

日期: 2024年5月7日

邮箱: mcxw@hust.edu.cn

---



[TOC]

## 1.项目背景

基于C3P0框架，分别使用MySQL驱动和openGauss(PG)驱动连接openGauss，对C3P0的全量API接口进行测试。测试的SQL应至少包含常用DDL、DML、DCL、存储过程等语法。输出测试报告。

技术要求：

1. 了解JDBC的使用方式。 2. 了解openGauss的基础功能。 3. 熟悉Java编程开发。

项目产出：

1. 基于C3P0框架，编写应用代码，分别使用MySQL驱动和openGauss(PG)驱动连接openGauss，获取C3P0框架的全量API接口，利用openGauss常用的DDL、DML、DCL、存储过程等语法测试相关API接口，输出测试结果。
1. 输出测试设计文档，测试设计文档需合入openGauss社区。 
1. 输出测试报告，测试报告文档需合入openGauss社区。

## 2.技术方法及可行性

该项目将基于Java语言的并发编程实现，我对Java的JUC较熟悉，如共享模型、非共享模型、Java并发锁、AQS、Java并发工具类、Java并发容器以及常用的JDBC的连接等。了解JDBC的使用方式。

我对openGauss数据库测试开发有项目经历，曾基于Spring Boot框架，Mybatis开发openGauss权限识别开源之夏2023项目。了解openGauss的基础功能。

## 3.项目实现细节梳理

### 3.1 连接数据库

1）连接openGauss数据库使用C3P0连接池和openGauss(PG)驱动

1. **添加依赖**：
   - 在项目的构建工具中添加C3P0和openGauss数据库驱动的依赖。
2. **配置C3P0连接池**：
   - 设置数据库连接的URL、用户名、密码等信息。
   - 配置连接池参数，如最大连接数、最小连接数、超时时间等。
3. **编写连接数据库的代码**：
   - 创建一个`DatabaseConnection`类，初始化`ComboPooledDataSource`作为连接池。
   - 设置openGauss数据库的连接信息。
   - 提供`getConnection()`方法用于获取数据库连接。

2）使用MySQL驱动连接openGauss数据库

1. **更改驱动**：
   - 将代码中的openGauss数据库驱动更改为MySQL数据库驱动。
2. **修改连接信息**：
   - 根据MySQL数据库的连接信息，更新代码中的URL、用户名和密码。
3. **重新测试连接**：
   - 运行应用程序，测试是否能够成功连接到openGauss数据库使用MySQL驱动。

### 3.2 获取并测试C3P0框架的全量API接口

1）获取C3P0框架的全量API接口

1. **查阅文档**：
   - 首先，查阅C3P0框架的官方文档或API文档，以了解框架提供的全部API接口和功能。
   - 比如**ComboPooledDataSource**：连接池数据源类，用于创建和管理数据库连接池。
     - `setJdbcUrl(String url)`：设置数据库的JDBC URL。
     - `setUser(String user)`：设置数据库用户名。
     - `setPassword(String password)`：设置数据库密码。
     - `setMinPoolSize(int size)`：设置连接池的最小连接数。
     - `setMaxPoolSize(int size)`：设置连接池的最大连接数。
     - `setAcquireIncrement(int increment)`：设置每次扩展连接池的连接数。
     - `setAcquireRetryAttempts(int attempts)`：设置获取连接时的重试次数。
2. **示例代码**：
   - 查找官方提供的示例代码或教程，以了解如何使用不同的API接口来配置和管理连接池。

2）测试C3P0框架的全量API接口

1. **编写测试代码**：
   - 创建一个测试类，利用openGauss常用的DDL、DML、DCL、存储过程等语法以测试C3P0框架的各种API接口。可以尝试创建连接池、获取连接、释放连接、设置连接池参数等操作。
2. **测试连接池功能**：
   - 测试连接池的功能，包括连接的获取和释放、连接池参数的设置和调整、连接的超时处理等。
3. **模拟异常情况**：
   - 测试异常情况下的处理，如连接超时、连接池耗尽等情况，确保框架能够正确处理这些情况。
4. **性能测试**：
   - 进行性能测试，测试连接池在高负载情况下的表现，包括连接的获取速度、连接池的扩展和收缩等。
5. **单元测试**：
   - 编写单元测试用例，覆盖各个API接口的功能，确保每个接口都能正常工作。
6. **集成测试**：
   - 进行集成测试，测试连接池与实际应用程序的集成情况，确保连接池能够正常工作并提供所需的功能。

### 3.3 测试用例编写

1. **编写测试设计文档**：记录测试的设计思路、测试用例、预期结果等信息，以便进行系统化的测试。
2. **执行测试**：执行测试用例，验证API接口的功能和性能，记录测试结果。

### 3.4 编写测试报告

**编写测试报告**：总结测试结果，包括测试过程中遇到的问题、解决方案、性能评估等信息，并撰写测试报告。

1. 输出测试设计文档，测试设计文档合入openGauss社区。 
2. 输出测试报告，测试报告文档合入openGauss社区。

## 4.规划

### 1.项目研发第一阶段

（07 月 01 日 - 08 月01 日）： 

在这个阶段，需要探索获取C3P0框架的全量API接口，了解openGauss常用的DDL、DML、DCL、存储过程等语法测试相关API接口的方法，并撰写技术洞察博客。

### 2.项目研发第二阶段

（08 月 02日 - 08 月 30 日）： 

在该阶段，需要确定项目技术栈、搭建开发环境、完成核心代码的编写、测试和优化。

分别使用MySQL驱动和openGauss(PG)驱动连接openGauss，获取C3P0框架的全量API接口，利用openGauss常用的DDL、DML、DCL、存储过程等语法测试相关API接口，输出测试结果。

### 3.项目总结与验收

（08 月 30日 - 09 月 30 日）： 

完善文档和测试用例，提高项目的可读性和可维护性。在该阶段，

- 需要编写详细的开发文档，介绍代码实现的细节和设计思路，并提供用户手册和常见问题解答。
- 也需要编写全面的测试用例，验证代码的正确性和稳定性，提高代码的质量和可靠性。

